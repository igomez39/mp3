---
title: "mp3"
author: "Selina Ho * Isabel Gomez"
date: "April 9, 2018"
output: html_document
---

##Load the packages

```{r, include=TRUE}
library(tidyverse)
library(leaflet)
library(sf)
library(macleish)
```

<<<<<<< HEAD
##Install macleish if not already downloaded
```{r setup, include=TRUE}
knitr::opts_chunk$set(echo = TRUE)
install.packages("macleish")

devtools::install_github("beanumber/macleish")
packageVersion("macleish")
```


## Step1 is to aggregate the data of the trail lengths and elevation change into one data frame

```{r, include=FALSE}
trail_lengths <-(macleish_layers[["trails"]]) %>%
    group_by(name) %>%
    summarize() %>%
    mutate(computed_length = st_length(geometry)) 

change_elevation <- (macleish_layers[["contours_30ft"]]) %>%
  mutate(change_in_elevation = st_length(geometry))


trails_elevation <- st_join(trail_lengths,change_elevation)


trails_elevation_condensed <- trails_elevation %>%
  group_by(name) %>%
  summarize(elevation_change = sum(change_in_elevation), trail_length = mean(computed_length)) %>%
  na.omit
```
 
##Our next step is to ensure that is to map our data using leaflet
```{r, include=TRUE}

<<<<<<< HEAD
st_bbox(macleish_layers[["trails"]])
=======
trails_elevation_condensed_andslope <- trails_elevation_condensed %>%
  group_by(name) %>%
  mutate(slope = trail_length/elevation_change) %>%
  arrange(desc(trail_length))

filtered_trails_elevation_condensed_andslope <- trails_elevation_condensed_andslope %>%
  filter(name %in% c("Eastern Loop", "Western Loop", "Porcupine Trail", "Vernal Pool Loop", "Easy Out"))

View(trails_elevation_condensed)

>>>>>>> 699457491782df276d97f6499d3631e12b3b9a24
leaflet() %>%
  addTiles() %>%
  addPolylines(data = trails_elevation_condensed)
```

##BUFFER
```{r, include=TRUE}
proj4_aea <- "+proj=aea +lat_1=29.5 +lat_2=45.5 +lat_0=37.5 +lon_0=-96 +x_0=0 +y_0=0 +ellps=GRS80 +datum=NAD83 +units=m +no_defs"

trails_buffer <- macleish_layers[["boundary"]] %>%
  st_transform(proj4_aea) %>%
  st_buffer(dist = 10) %>%
  st_transform(4326)

<<<<<<< HEAD
pal <- colorNumeric(
  palette = "viridis",
  domain = 
)
trails_elevation_condensed$name <- factor(sample.int(9L, nrow(trails_elevation_condensed), TRUE))

factpal <- colorFactor(topo.colors(9), trails_elevation_condensed$name)


leaflet() %>%
  addTiles() %>%
addPolylines(data = macleish_layers[["trails"]], weight = 3, color = ~"red")

leaflet() %>%
  addTiles() %>%
  addPolylines(data = trails_elevation_condensed, 
               weight = 1,stroke = FALSE, smoothFactor = 0.2, fillOpacity = 1,
               color= ~factpal(name)) %>%
  addPolygons(data = trails_buffer)
=======
#COLOR FACTORSSSSS
  pal1 <- colorFactor(
  palette = "Blues",
  domain = filtered_trails_elevation_condensed_andslope$name
)

trails_elevation_condensed_4326 <- trails_elevation_condensed %>%
  st_transform(4326)
trails_elevation_condensed_4326

leaflet() %>%
  addTiles() %>%
  addPolylines(data = filtered_trails_elevation_condensed_andslope, color = ~pal1(name)) %>%
    addPolygons(data = macleish_layers[["boundary"]], weight = 1, fillOpacity = 0.01, group = "Boundaries", color = "brown") %>%
  addMarkers(lng = ~lon, lat = ~lat, data = bechtel,
             popup = "Bechtel Environmental Classroom")

pal3 <- colorFactor(palette = c("#4b7fd8"), domain = filtered_trails_elevation_condensed_andslope$name)

#color for which trail, for difficulty, for slope, for length, 

terrain(macleish_layers[["trails"]], opt=c('slope', 'aspect'), unit='degrees')

#plzhelp

=======
  addPolylines()
>>>>>>> e06ff4e4534c939066c02b8ade3c92382cb99381
>>>>>>> 699457491782df276d97f6499d3631e12b3b9a24
```

