---
title: "mp3"
author: "Selina Ho"
date: "April 9, 2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(leaflet)
library(sf)
library(macleish)

install.packages("macleish")

devtools::install_github("beanumber/macleish")

library(macleish)
packageVersion("macleish")
names(macleish_layers)


leaflet(data = trail_lengths) %>%
  addTiles() %>%
  addPolylines()
trail_lengths <-(macleish_layers[["trails"]]) %>%
    group_by(name) %>%
    summarize() %>%
  mutate(computed_length = st_length(geometry))

change_elevation <- (macleish_layers[["contours_30ft"]]) %>%
  mutate(change_in_elevation = st_length(geometry))

View(change_elevation)

View(macleish_layers[["contours_30ft"]])

trails_elevation <- st_join(trail_lengths,change_elevation)


View(trails_elevation)

trails_elevation_condensed <- trails_elevation %>%
  group_by(name) %>%
  summarize(elevation_change = sum(change_in_elevation), trail_length = mean(computed_length)) %>%
  na.omit

trails_elevation_condensed_andslope <- trails_elevation_condensed %>%
  group_by(name) %>%
  mutate(slope = trail_length/elevation_change) %>%
  arrange(desc(trail_length))

filtered_trails_elevation_condensed_andslope <- trails_elevation_condensed_andslope %>%
  filter(name %in% c("Eastern Loop", "Western Loop", "Porcupine Trail", "Vernal Pool Loop", "Easy Out"))

View(trails_elevation_condensed)

leaflet() %>%
  addTiles() %>%
  addPolylines(data = trails_elevation_condensed)

pal1 <- colorFactor(
  palette = "Blues",
  domain = trails_elevation_condensed_andslope$name
)

trails_elevation_condensed_4326 <- trails_elevation_condensed %>%
  st_transform(4326)
trails_elevation_condensed_4326

leaflet() %>%
  addTiles() %>%
  addPolylines(data = filtered_trails_elevation_condensed_andslope, color = ~pal3(name)) %>%
    addPolygons(data = macleish_layers[["boundary"]], weight = 1, fillOpacity = 0.01, group = "Boundaries", color = "brown") %>%
  addMarkers(lng = ~lon, lat = ~lat, data = bechtel,
             popup = "Bechtel Environmental Classroom")

pal3 <- colorFactor(palette = c("#4b7fd8"), domain = filtered_trails_elevation_condensed_andslope$name)

#color for which trail, for difficulty, for slope, for length, 

terrain(macleish_layers[["trails"]], opt=c('slope', 'aspect'), unit='degrees')

```

